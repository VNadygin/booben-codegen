{"version":3,"sources":["../lib/generateFiles.js"],"names":["generateComponentFile","require","generateFunctionsFile","generateEntryPointFile","generateEntryHTMLFile","generatePackageJSONFile","generateHelpersFile","generateCSSFile","entryPointFile","stylesFile","functionsFile","helpersFile","componentsDirectory","defaultContainerId","entryHTMLFile","generateFiles","model","version","urlPrefix","containerId","ret","src","type","content","public","Object","keys","functions","length","helpers","openUrl","createComponentFile","file","directoryNode","nestingLevel","name","nestedFiles","forEach","nestedFile","files","module","exports"],"mappings":"AAAA;;;;AAEA,IAAMA,wBAAwBC,QAAQ,yBAAR,CAA9B;AACA,IAAMC,wBAAwBD,QAAQ,yBAAR,CAA9B;AACA,IAAME,yBAAyBF,QAAQ,0BAAR,CAA/B;AACA,IAAMG,wBAAwBH,QAAQ,yBAAR,CAA9B;AACA,IAAMI,0BAA0BJ,QAAQ,2BAAR,CAAhC;AACA,IAAMK,sBAAsBL,QAAQ,uBAAR,CAA5B;AACA,IAAMM,kBAAkBN,QAAQ,mBAAR,CAAxB;;eAUIA,QAAQ,aAAR,C;IAPFO,c,YAAAA,c;IACAC,U,YAAAA,U;IACAC,a,YAAAA,a;IACAC,W,YAAAA,W;IACAC,mB,YAAAA,mB;IACAC,kB,YAAAA,kB;IACAC,a,YAAAA,a;;AAGF;;;;;;AAMA;;;;;;;;;;AAQA,IAAMC,gBAAgB,SAAhBA,aAAgB,CACpBC,KADoB,EAGjB;AAAA;;AAAA,iFADwE,EACxE;AAAA,0BADDC,OACC;AAAA,MADDA,OACC,gCADS,OACT;AAAA,4BADkBC,SAClB;AAAA,MADkBA,SAClB,kCAD8B,GAC9B;AAAA,8BADmCC,WACnC;AAAA,MADmCA,WACnC,oCADiDN,kBACjD;;AACH,MAAMO,MAAM;AACVC,SAAK;AACHC,YAAM,KADH;AAEHC,yDACGX,mBADH,EACyB;AACrBU,cAAM,KADe;AAErBC,iBAAS;AAFY,OADzB,6BAKGf,cALH,EAKoB;AAChBc,cAAM,MADU;AAEhBC,iBAASpB,uBAAuBa,KAAvB,EAA8B,EAAEE,oBAAF,EAAaC,wBAAb,EAA9B;AAFO,OALpB,6BASGV,UATH,EASgB;AACZa,cAAM,MADM;AAEZC,iBAAShB,gBAAgBS,KAAhB,EAAuB,EAAEE,oBAAF,EAAaC,wBAAb,EAAvB;AAFG,OAThB;AAFG,KADK;AAkBVK,YAAQ;AACNF,YAAM,KADA;AAENC,mCACGT,aADH,EACmB;AACfQ,cAAM,MADS;AAEfC,iBAASnB;AAFM,OADnB;AAFM,KAlBE;AA2BV,oBAAgB;AACdkB,YAAM,MADQ;AAEdC,eAASlB,wBAAwBW,KAAxB,EAA+B,EAAEC,gBAAF,EAA/B;AAFK;AA3BN,GAAZ;;AAiCA,MAAIQ,OAAOC,IAAP,CAAYV,MAAMW,SAAlB,EAA6BC,MAA7B,GAAsC,CAA1C,EAA6C;AAC3CR,QAAIC,GAAJ,CAAQE,OAAR,CAAgBb,aAAhB,IAAiC;AAC/BY,YAAM,MADyB;AAE/BC,eAASrB,sBAAsBc,MAAMW,SAA5B;AAFsB,KAAjC;AAID;;AAED,MAAIX,MAAMa,OAAN,CAAcC,OAAlB,EAA2B;AACzBV,QAAIC,GAAJ,CAAQE,OAAR,CAAgBZ,WAAhB,IAA+B;AAC7BW,YAAM,MADuB;AAE7BC,eAASjB,oBAAoBU,MAAMa,OAA1B;AAFoB,KAA/B;AAID;;AAED,MAAME,sBAAsB,SAAtBA,mBAAsB,CAACC,IAAD,EAAOC,aAAP,EAA2C;AAAA,QAArBC,YAAqB,uEAAN,CAAM;;AACrED,kBAAcV,OAAd,CAAsBS,KAAKG,IAA3B,IAAmC;AACjCb,YAAM,KAD2B;AAEjCC,mCACMS,KAAKG,IADX,UACuB;AACnBb,cAAM,MADa;AAEnBC,iBAASvB,sBAAsBgC,IAAtB,EAA4BhB,KAA5B,EAAmCkB,YAAnC;AAFU,OADvB;AAFiC,KAAnC;;AAUAF,SAAKI,WAAL,CAAiBC,OAAjB,CAAyB,sBAAc;AACrCN,0BACEO,UADF,EAEEL,cAAcV,OAAd,CAAsBS,KAAKG,IAA3B,CAFF,EAGED,eAAe,CAHjB;AAKD,KAND;AAOD,GAlBD;;AAoBAlB,QAAMuB,KAAN,CAAYF,OAAZ,CAAoB,gBAAQ;AAC1BN,wBAAoBC,IAApB,EAA0BZ,IAAIC,GAAJ,CAAQE,OAAR,CAAgBX,mBAAhB,CAA1B;AACD,GAFD;;AAIA,SAAOQ,GAAP;AACD,CA5ED;;AA8EAoB,OAAOC,OAAP,GAAiB1B,aAAjB","file":"generateFiles.js","sourcesContent":["'use strict';\n\nconst generateComponentFile = require('./generateComponentFile');\nconst generateFunctionsFile = require('./generateFunctionsFile');\nconst generateEntryPointFile = require('./generateEntryPointFile');\nconst generateEntryHTMLFile = require('./generateEntryHTMLFile');\nconst generatePackageJSONFile = require('./generatePackageJSONFile');\nconst generateHelpersFile = require('./generateHelpersFile');\nconst generateCSSFile = require('./generateCSSFile');\n\nconst {\n  entryPointFile,\n  stylesFile,\n  functionsFile,\n  helpersFile,\n  componentsDirectory,\n  defaultContainerId,\n  entryHTMLFile,\n} = require('./constants');\n\n/**\n * @typedef {Object} FSNode\n * @property {string} type\n * @property {string|Buffer|Object<string, FSNode>} content\n */\n\n/**\n *\n * @param {JssyProjectModel} model\n * @param {string} [version='1.0.0']\n * @param {string} [urlPrefix='/']\n * @param {string} [containerId]\n * @return {Object<string, FSNode>}\n */\nconst generateFiles = (\n  model,\n  { version = '1.0.0', urlPrefix = '/', containerId = defaultContainerId } = {}\n) => {\n  const ret = {\n    src: {\n      type: 'dir',\n      content: {\n        [componentsDirectory]: {\n          type: 'dir',\n          content: {},\n        },\n        [entryPointFile]: {\n          type: 'file',\n          content: generateEntryPointFile(model, { urlPrefix, containerId }),\n        },\n        [stylesFile]: {\n          type: 'file',\n          content: generateCSSFile(model, { urlPrefix, containerId }),\n        },\n      },\n    },\n    public: {\n      type: 'dir',\n      content: {\n        [entryHTMLFile]: {\n          type: 'file',\n          content: generateEntryHTMLFile(),\n        },\n      },\n    },\n    'package.json': {\n      type: 'file',\n      content: generatePackageJSONFile(model, { version }),\n    },\n  };\n\n  if (Object.keys(model.functions).length > 0) {\n    ret.src.content[functionsFile] = {\n      type: 'file',\n      content: generateFunctionsFile(model.functions),\n    };\n  }\n\n  if (model.helpers.openUrl) {\n    ret.src.content[helpersFile] = {\n      type: 'file',\n      content: generateHelpersFile(model.helpers),\n    };\n  }\n\n  const createComponentFile = (file, directoryNode, nestingLevel = 0) => {\n    directoryNode.content[file.name] = {\n      type: 'dir',\n      content: {\n        [`${file.name}.js`]: {\n          type: 'file',\n          content: generateComponentFile(file, model, nestingLevel),\n        },\n      },\n    };\n\n    file.nestedFiles.forEach(nestedFile => {\n      createComponentFile(\n        nestedFile,\n        directoryNode.content[file.name],\n        nestingLevel + 1\n      );\n    });\n  };\n\n  model.files.forEach(file => {\n    createComponentFile(file, ret.src.content[componentsDirectory]);\n  });\n\n  return ret;\n};\n\nmodule.exports = generateFiles;\n"]}